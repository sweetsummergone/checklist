<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="pages/index.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />

    <title>Checklist</title>
  </head>
  <button class="button__sidebar-toggle" id="button_sidebar" title="Toggle sidebar"></button>
  <button class="button__dark-mode" id="button_dark" title="Dark mode"></button>
  <button onclick="downloadInnerHtml(fileName, '.list','text/html')" class="button__download" id="button_download" title="Save ul"></button>
  <body id="main" class="main">
    <!-- Sidebar -->
    <div id="sidebar" class="collapsed">
      <button id="sidebar_closer" title="Close sidebar"></button>
      <form class="sidebar">
        <label for="sidebar__ul">Paste ul here</label>
        <textarea class="sidebar__textarea form-control" id="sidebar__ul" rows="3"></textarea>
        <button type="button" id="sidebar__save" onclick="setul()">Save</button>
      </form>
    </div>
    <!-- /#sidebar-wrapper -->

    <section class="content" id="content">
      <ul class="list">
        <li class="crossed">All comments in the code</li>
        <li>
          Make homework at least 3 hours
          <code class="code-inline">make_homevork(3)</code>
        </li>
        <li class="crossed">
          Drink some water
        </li>
        <li>
          Call a friend
        </li>
      </ul>
    </div>
    <script>
      pasteCheckboxes();

      function pasteCheckboxes() {
        var list = document.querySelectorAll("li");
        // appending the checkbox
        for (var i = 0; i < list.length; i++) {
          // creating checkbox element
          var checkbox = document.createElement("input");

          // Assigning the attributes
          // to created checkbox
          checkbox.classList.add("form-check-input");
          checkbox.type = "checkbox";
          checkbox.value = "";
          checkbox.id = "id__" + i;
          if(list[i].classList.contains("crossed")) {
            checkbox.defaultChecked = true;
          }

          var label = document.createElement("label");
          label.classList.add("form-check-label");
          label.htmlFor = "id__" + i;

          org_html = list[i].innerHTML;
          new_html =
            checkbox.outerHTML +
            label.outerHTML.substring(0, label.outerHTML.length - 8) + // Only for label type
            org_html +
            "</label>";
          list[i].innerHTML = new_html;
        }
      }

      function setul() {
        document.querySelector("ul").innerHTML =
          document.querySelector("#sidebar__ul").value;
        pasteCheckboxes();
      }

      function downloadInnerHtml(filename, el, mimeType) {
        var elHtml = document.querySelector(el).innerHTML;
        var link = document.createElement('a');
        mimeType = mimeType || 'text/plain';

        link.setAttribute('download', filename);
        link.setAttribute('href', 'data:' + mimeType  +  ';charset=utf-8,' + encodeURIComponent(elHtml));
        link.click();
      }

      var fileName =  'ul.txt'; // You can use the .txt extension if you want


    </script>
    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"
      integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s"
      crossorigin="anonymous"
    ></script>
    <script src="./admin.js"></script>
  </body>
</html>
